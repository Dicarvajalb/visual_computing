<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="1. Convoluciones # Problem statement # Una convolucion sobre una imagen es un calculo matematico sobre un conjunto de pixeles sobre la misma, esta operacion hace uso de los denominados Kernel; Un kernel es una matriz con valores determinados los cuales permiten aplicar diferentes mascaras sobre las imagenes, los valores dentro de las matrices de los kernel se pueden alterar con base en el resultado que se desee obtener se pueden modificar."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="1. Convoluciones # Problem statement # Una convolucion sobre una imagen es un calculo matematico sobre un conjunto de pixeles sobre la misma, esta operacion hace uso de los denominados Kernel; Un kernel es una matriz con valores determinados los cuales permiten aplicar diferentes mascaras sobre las imagenes, los valores dentro de las matrices de los kernel se pueden alterar con base en el resultado que se desee obtener se pueden modificar."><meta property="og:type" content="article"><meta property="og:url" content="https://dicarvajalb.github.io/visual_computing/docs/shortcodes/Taller-1/Convoluciones/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-09-05T09:14:50-05:00"><title>Convoluciones | Showcase Template</title><link rel=manifest href=/visual_computing/manifest.json><link rel=icon href=/visual_computing/favicon.png type=image/x-icon><link rel=stylesheet href=/visual_computing/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/visual_computing/flexsearch.min.js></script>
<script defer src=/visual_computing/en.search.min.d118d633fbb288a3309890e3846b0d226fb8730d2626c156705b4f2db862768f.js integrity="sha256-0RjWM/uyiKMwmJDjhGsNIm+4cw0mJsFWcFtPLbhido8=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/visual_computing/><span>Showcase Template</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Shortcodes</span><ul><li><input type=checkbox id=section-543c92395a5da43e568c54aed57a7bf6 class=toggle checked>
<label for=section-543c92395a5da43e568c54aed57a7bf6 class="flex justify-between"><a href=/visual_computing/docs/shortcodes/Taller-1/>Taller 1</a></label><ul><li><a href=/visual_computing/docs/shortcodes/Taller-1/Convoluciones/ class=active>Convoluciones</a></li><li><a href=/visual_computing/docs/shortcodes/Taller-1/Histograma/>Histograma</a></li><li><input type=checkbox id=section-eb58e35b3307a51faa32e78ab05d9c64 class=toggle>
<label for=section-eb58e35b3307a51faa32e78ab05d9c64 class="flex justify-between"><a href=/visual_computing/docs/shortcodes/Taller-1/Ilusiones/>Ilusiones</a></label><ul><li><a href=/visual_computing/docs/shortcodes/Taller-1/Ilusiones/BindingMovement/>Binding Movement</a></li><li><a href=/visual_computing/docs/shortcodes/Taller-1/Ilusiones/SKE/>Ske</a></li><li><a href=/visual_computing/docs/shortcodes/Taller-1/Ilusiones/SteppingFeet/>Stepping Feet</a></li></ul></li><li><a href=/visual_computing/docs/shortcodes/Taller-1/Lightness/>Lightness</a></li><li><a href=/visual_computing/docs/shortcodes/Taller-1/Multiplicacion-RGB/>Multiplicacion Rgb</a></li></ul></li></ul></li></ul><ul><li><a href=/visual_computing/posts/>Blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/visual_computing/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Convoluciones</strong>
<label for=toc-control><img src=/visual_computing/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#1-convoluciones><strong>1. Convoluciones</strong></a><ul><li><a href=#problem-statement>Problem statement</a></li><li><a href=#background>Background</a></li><li><a href=#code>Code</a></li><li><a href=#conclusions>Conclusions</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=1-convoluciones><strong>1. Convoluciones</strong>
<a class=anchor href=#1-convoluciones>#</a></h1><hr><h2 id=problem-statement>Problem statement
<a class=anchor href=#problem-statement>#</a></h2><p>Una convolucion sobre una imagen es un calculo matematico sobre un conjunto de pixeles sobre la misma, esta operacion hace uso de los denominados <strong>Kernel</strong>;
Un kernel es una matriz con valores determinados los cuales permiten aplicar diferentes mascaras sobre las imagenes, los valores dentro de las matrices de los kernel se pueden alterar con base en el resultado que se desee obtener se pueden modificar.</p><ul><li>Se desea una aplicacion web que pueda aplicar diferentes convoluciones a una imagen.</li></ul><h2 id=background>Background
<a class=anchor href=#background>#</a></h2><p>La <strong>operacion de convolucion</strong> se define como:</p><link rel=stylesheet href=/visual_computing/katex/katex.min.css><script defer src=/visual_computing/katex/katex.min.js></script>
<script defer src=/visual_computing/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>
\[g(x,y)=\omega *f(x,y)=\sum _{dx=-a}^{a}{\sum _{dy=-b}^{b}{\omega (dx,dy)f(x-dx,y-dy)}}\]</span><p>Sin embargo, se puede definir mas facilmente si se utiliza el kernel como un vector 1-dimensional asi. Con este vector, se toman los 4 canales <strong><strong>R,G,B,A</strong></strong> y se separan en vectores que puedan operarse de manera escalar, recordemos que el producto escalar entre dos vectores se define como;</p><span>\[u \cdot v = u {\displaystyle =u_{1}\cdot v_{1}+u_{2}\cdot v_{2}+...+u_{n}\cdot v_{n}} {\displaystyle =u_{1}\cdot v_{1}+u_{2}\cdot v_{2}+...+u_{n}\cdot v_{n}},\]</span><p><strong>Precaucion</strong></p><blockquote><p>Al operar la imagen se deben tener en cuenta la inexistencia de pixeles externos, si se aplicara la convolucion donde el centro del kernel se ubica sobre el primer pixel, habran posiciones que no esten definidas por lo cual hay dos posibles alternativas.</p></blockquote><ul><li>Operar desde el pixel <strong>(1,1)</strong></li><li>Operar desde el pixel <strong>(0,0)</strong> pero reescribiendo toda la imagen añadiendo pixeles de valor 0 al rededor de la imagen;</li></ul><hr><blockquote class="book-hint info"><strong>¿Como interactuar con la ilusión?</strong><br>Para cambiar los efectos sobre la imagen hay de usar el Slider para seleccionar uno
de los kernels, ya despues de seleccionado se debe presionar el boton <strong>Recargar canvas</strong>.</blockquote><h2 id=code>Code
<a class=anchor href=#code>#</a></h2><iframe id=convolutions style=width:625px;height:625px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=/visual_computing/sketches/convolutions.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe>
<details><summary><strong>CODIGO:</strong> Convoluciones</summary><div class=markdown-inner><p><strong>C</strong>odigo generado usando el editor web de <strong>P5.js</strong>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>img</span>,<span style=color:#a6e22e>kernel</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>channelsMap</span>,<span style=color:#a6e22e>RedMat</span>,<span style=color:#a6e22e>BlueMat</span>,<span style=color:#a6e22e>GreenMat</span>,<span style=color:#a6e22e>newChannels</span>,<span style=color:#a6e22e>fMap</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#39;/showcase/sketches/bubbleCatC.png&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>,<span style=color:#ae81ff>600</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noLoop</span>();
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>//Boton de Recarga
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createButton</span>(<span style=color:#e6db74>&#39;Recargar Canvas&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>mousePressed</span>(<span style=color:#a6e22e>reload</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>//Cambiar el kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>slider</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#39;width&#39;</span>, <span style=color:#e6db74>&#39;120px&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Calcular el producto punto
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>ppunto</span>(<span style=color:#a6e22e>Pix</span>,<span style=color:#a6e22e>Ker</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>sum</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;<span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>Ker</span>.<span style=color:#a6e22e>length</span>;<span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sum</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sum</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>Pix</span>[<span style=color:#a6e22e>x</span>]<span style=color:#f92672>*</span><span style=color:#a6e22e>Ker</span>[<span style=color:#a6e22e>x</span>])
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>sum</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Dividimos los canales en arreglos individuales
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>ChannelDivider</span>(<span style=color:#a6e22e>ImgArr</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>imgRed</span> <span style=color:#f92672>=</span> [], <span style=color:#a6e22e>imgGreen</span> <span style=color:#f92672>=</span> [], <span style=color:#a6e22e>imgBlue</span> <span style=color:#f92672>=</span> [], <span style=color:#a6e22e>imgAlpha</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>ImgArr</span>.<span style=color:#a6e22e>length</span> ; <span style=color:#a6e22e>i</span><span style=color:#f92672>+=</span><span style=color:#ae81ff>4</span>){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgRed</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>ImgArr</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgGreen</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>ImgArr</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgBlue</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>ImgArr</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imgAlpha</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>ImgArr</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>]);
</span></span><span style=display:flex><span>    } 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [<span style=color:#a6e22e>imgRed</span>,<span style=color:#a6e22e>imgGreen</span>,<span style=color:#a6e22e>imgBlue</span>,<span style=color:#a6e22e>imgAlpha</span>]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Recomponer la imagen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>ChannelComposer</span>(<span style=color:#a6e22e>R</span>,<span style=color:#a6e22e>G</span>,<span style=color:#a6e22e>B</span>,<span style=color:#a6e22e>A</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>imageChannels</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>A</span>.<span style=color:#a6e22e>length</span><span style=color:#f92672>*</span><span style=color:#ae81ff>4</span> ; <span style=color:#a6e22e>i</span><span style=color:#f92672>+=</span><span style=color:#ae81ff>4</span>){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imageChannels</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>R</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imageChannels</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>G</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imageChannels</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>B</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imageChannels</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>A</span>[<span style=color:#a6e22e>i</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>imageChannels</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//separar los arreglos para hacer una matriz
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>ArraySplice</span>(<span style=color:#a6e22e>arr</span>,<span style=color:#a6e22e>dim</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>matrix</span> <span style=color:#f92672>=</span> [], <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>k</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>k</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>arr</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>%</span> <span style=color:#a6e22e>dim</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>k</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>matrix</span>[<span style=color:#a6e22e>k</span>] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>matrix</span>[<span style=color:#a6e22e>k</span>].<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>arr</span>[<span style=color:#a6e22e>i</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>matrix</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//Reescribir el arreglo como matriz 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>dimensioner</span>(<span style=color:#a6e22e>LTM</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>extended</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>r</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>LTM</span>.<span style=color:#a6e22e>length</span> ; <span style=color:#a6e22e>r</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>c</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>c</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            <span style=color:#75715e>//Si estoy en el primer pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>r</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>(
</span></span><span style=display:flex><span>                    [<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]]
</span></span><span style=display:flex><span>                );    
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//si estoy en la primer fila
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>r</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>c</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span><span style=color:#f92672>!=</span><span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>(
</span></span><span style=display:flex><span>                    [<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]]
</span></span><span style=display:flex><span>                );
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//Si estoy en el el ultimo pixel de una fila
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>r</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span><span style=color:#f92672>==</span><span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>(
</span></span><span style=display:flex><span>                    [<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>                ); 
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>//si estoy en el primer pixel de una columna
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>((<span style=color:#a6e22e>r</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>r</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>(
</span></span><span style=display:flex><span>                    [<span style=color:#ae81ff>0</span>,<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]]
</span></span><span style=display:flex><span>                );    
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>//si estoy en el ultimo pixel de una columna y no es la ultima fila
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>((<span style=color:#a6e22e>r</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>r</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span><span style=color:#f92672>==</span><span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>(
</span></span><span style=display:flex><span>                    [<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>                );    
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//si estoy en el primer pixel de la ultima fila
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>r</span><span style=color:#f92672>==</span><span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>(
</span></span><span style=display:flex><span>                    [<span style=color:#ae81ff>0</span>,<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>                );    
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>//si estoy en la ultima fila
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>r</span><span style=color:#f92672>==</span><span style=color:#a6e22e>LTM</span>.<span style=color:#a6e22e>length</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>c</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>(
</span></span><span style=display:flex><span>                    [<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>                );
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//si estoy en el ultimo pixel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>r</span><span style=color:#f92672>==</span><span style=color:#a6e22e>LTM</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>c</span><span style=color:#f92672>==</span><span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>].<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>(
</span></span><span style=display:flex><span>                    [<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>                ); 
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>            <span style=color:#75715e>//los demas pixeles
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>extended</span>.<span style=color:#a6e22e>push</span>([<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                          <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>                          <span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span>],<span style=color:#a6e22e>LTM</span>[<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>][<span style=color:#a6e22e>c</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]])
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>extended</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Calculo de la convolucion
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Convolution</span>(<span style=color:#a6e22e>mat</span>,<span style=color:#a6e22e>ker</span>,<span style=color:#a6e22e>w</span>){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>conv</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>mat</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ppunto</span>(<span style=color:#a6e22e>mat</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>reverse</span>(),<span style=color:#a6e22e>ker</span>);    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>conv</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>p</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>conv</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Calculo del la imagen con el nuevo 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>CoreCalc</span>(<span style=color:#a6e22e>kernel</span>,<span style=color:#a6e22e>pix</span>, <span style=color:#a6e22e>width</span>){
</span></span><span style=display:flex><span> <span style=color:#75715e>//Creamos el espacio para todos los canales tras la convolucion
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>newChannels</span> <span style=color:#f92672>=</span> [[],[],[]];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>//Asignamos todos los canales
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>channelsMap</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ChannelDivider</span>(<span style=color:#a6e22e>pix</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>//Transformamos cada canal en una matriz para el dimensionamiento;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>RedMat</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ArraySplice</span>(<span style=color:#a6e22e>channelsMap</span>[<span style=color:#ae81ff>0</span>],<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>GreenMat</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ArraySplice</span>(<span style=color:#a6e22e>channelsMap</span>[<span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>BlueMat</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ArraySplice</span>(<span style=color:#a6e22e>channelsMap</span>[<span style=color:#ae81ff>2</span>],<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>//Se  Crea el arreglo adecuado para cada matriz
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>RT</span>,<span style=color:#a6e22e>GT</span>,<span style=color:#a6e22e>BT</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>RT</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dimensioner</span>(<span style=color:#a6e22e>RedMat</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>GT</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dimensioner</span>(<span style=color:#a6e22e>GreenMat</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>BT</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dimensioner</span>(<span style=color:#a6e22e>BlueMat</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>//Aplicamos el kernel a cada canal
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>newChannels</span>[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>Convolution</span>(<span style=color:#a6e22e>RT</span>,<span style=color:#a6e22e>kernel</span>,<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newChannels</span>[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>Convolution</span>(<span style=color:#a6e22e>GT</span>,<span style=color:#a6e22e>kernel</span>,<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>newChannels</span>[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>Convolution</span>(<span style=color:#a6e22e>BT</span>,<span style=color:#a6e22e>kernel</span>,<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>fMap</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ChannelComposer</span>(<span style=color:#a6e22e>newChannels</span>[<span style=color:#ae81ff>0</span>],<span style=color:#a6e22e>newChannels</span>[<span style=color:#ae81ff>1</span>],<span style=color:#a6e22e>newChannels</span>[<span style=color:#ae81ff>2</span>],<span style=color:#a6e22e>channelsMap</span>[<span style=color:#ae81ff>3</span>]);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fMap</span>;
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Funcion de recarga
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>reload</span>(){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>clear</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>redraw</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>kernels</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>identity</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sharpen</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>boxBlur</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>edgeDetection</span><span style=color:#f92672>:</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>8</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>gaussianBlur</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>emboss</span><span style=color:#f92672>:</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bottomSobel</span><span style=color:#f92672>:</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>outline</span><span style=color:#f92672>:</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>8</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>topSobel</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>220</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>//image(img, 10, 10);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>//Cambiar los canvas
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>identity</span>; <span style=color:#75715e>//restaurar
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>sharpen</span>; <span style=color:#75715e>//definir
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>boxBlur</span>; <span style=color:#75715e>//blur cuadrado
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>emboss</span> <span style=color:#75715e>//viselar
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>gaussianBlur</span> <span style=color:#75715e>//blur gaussiano
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>6</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>bottomSobel</span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>7</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>topSobel</span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#ae81ff>8</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>outline</span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>kernel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>kernels</span>.<span style=color:#a6e22e>edgeDetection</span>; <span style=color:#75715e>//deteccion de bordes fuerte
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>finalMap</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>CoreCalc</span>(<span style=color:#a6e22e>kernel</span>,<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>,<span style=color:#a6e22e>d</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>imgs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createImage</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imgs</span>.<span style=color:#a6e22e>loadPixels</span>()
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;<span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>;<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>imgs</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>finalMap</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imgs</span>.<span style=color:#a6e22e>updatePixels</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>imgs</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><hr><h2 id=conclusions>Conclusions
<a class=anchor href=#conclusions>#</a></h2><p>El ejercicio es bastante complejo debido a las limitantes que existen al momento del renderizado, Sin embargo la manipulacion matematica de la imagen permite un acercamiento practico a funciones utilizadas por editores graficos lo cual permite entender que procesos se realizan bajo las interfaces para poder obtener resultados.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/Dicarvajalb/visual_computing/commit/c20d60cc3840294570828325110cf4d251f349d1 title='Last modified by dleonmu | September 5, 2022' target=_blank rel=noopener><img src=/visual_computing/svg/calendar.svg class=book-icon alt=Calendar>
<span>September 5, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#1-convoluciones><strong>1. Convoluciones</strong></a><ul><li><a href=#problem-statement>Problem statement</a></li><li><a href=#background>Background</a></li><li><a href=#code>Code</a></li><li><a href=#conclusions>Conclusions</a></li></ul></li></ul></nav></div></aside></main></body></html>